<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{/layout/header::head('관리자 FAQ관리페이지')}"></head>

<style>
  
  #title { 
    text-align: center;
  }
  .main_title {
    text-align: center;
  }
  
  .list {
    word-spacing: normal;
  }
  
</style>




<body>
  
  <div th:replace="~{/layout/header::header}"></div>
  
  <H3 id="title">관리자 페이지</H3>
    
    <div class="main_wrap">
      <div class="form-group">
        <form id="add_frm" method="post" th:action="@{/faq/add.do}">
          <div class="form-group">
            <label for="category_select" class="form-label mt-4">카테고리 선택</label>
            <select class="form-select" id="categoryNo" name="categoryNo" th:value="categoryNo">
              <option value="">--선택 안함--</option>
              <th:block th:each="product : ${categoryList.getCategoryList}">
                <th:block th:if="${product.categoryNo != 0}">
                  <option th:value="${product.categoryNo}" th:text="${product.categoryName}"></option>
                </th:block>
              </th:block>
              
              <th:block th:each="faq : ${faqCategoryList.getfaqCategoryList}">
                <th:block th:if="${faq.faqCategoryNo != 0}">
                  <option th:value="${faq.faqCategoryNo}" th:text="${faq.faqCategoryName}"></option>
                </th:block>
            </select>
        <div class="invalid-feedback"></div>
      </div>
      <div class="form-group">
        <label for="faqTitle" class="form-label mt-4">제목</label>
        <input type="text" class="form-control not-empty" name="faqTitle" id="faqTitle">  
        <div class="invalid-feedback"></div>
      </div>
      <div class="form-group">
        <label for="faqContents" class="form-label mt-4">내용</label>
        <input type="text" class="form-control not-empty" name="faqContents" id="faqContents">
        <div class="invalid-feedback"></div>
      </div>
      <div class="text-center mt-3">
      <a><button class="btn btn-secondary" type="button">작성취소</button></a>
         <button type="submit" class="btn btn-primary">작성완료</button>
      </div>
     </form>
   </div>
   
      <div class="table_wrap">
       <form id="update_frm" method="post" th:action="@{/faq/update.do}">
        <table class="table" border="1">
          <thead class="table-li">
            <tr>
              <td>번호</td>
              <td>카테고리</td>
              <td>제목</td>
              <td>답변내용</td>
            </tr>
          </thead>
          <tbody>
            <th:block th:each="a,vs:${adminList}">
              <tr class="list">
                <td th:text="${beginNo - vs.index}"></td>
                <td><input type="text" name="faqName" th:value="${a.faqName}" size="4"></input></td>
                <td><input type="text" name="faqTitle" th:value="${a.faqTitle}"></input></td>
                <td><input type="text" name="faqContents" th:value="${a.faqContents}" ></span></td>
                <td><span th:each="n:${#numbers.sequence(1, a.depth, 1)}" th:utext="|&nbsp;&nbsp;|"></span>
                <td>
                  <input type="hidden"  id="faqNo" name="faqNo" th:value="${a.faqNo}">  
                  <button type="submit" id="modify_btn">수정</button>
                  <button type="button" id="delete_btn">삭제</button>
                </td>
              </tr>
            </th:block>
          </tbody>
          <tfoot>
            <tr>
              <td colspan="4" th:utext="${paging}"></td>
            </tr>
          </tfoot>
        </table>
       </form>
      </div>
   
   
   
   <script>
   
      const fnDelete = () => {
        $(document).on('click', '#delete_btn', function(){
          var faqNo = $(this).find('.faqNo');
          console.log(faqNo);
          $.ajax({
            type: 'post',
            url: '/faq/delete.do',
            data: faqNo,
            dataType: 'json',
            success: (resData) => {  
              alert('FAQ가 삭제되었습니다.')
            }
          })
        })
      };
      
    
    fnDelete();
    
   </script>

  <div th:replace="~{/layout/footer::footer}"></div>
  
</body>
</html>
